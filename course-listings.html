<!doctype html>
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><html lang="en" class="no-js"> <![endif]-->
<html lang="en">

<head>

  <!-- Basic -->
  <title>MSCschedulizer</title>

  <!-- Define Charset -->
  <meta charset="utf-8">
  
  <link rel="icon" type="image/png" href="favicon.png">
  
  <!-- Responsive Metatag -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <!-- Bootstrap CSS  -->
  <link rel="stylesheet" href="asset/css/bootstrap.min.css" type="text/css" media="screen">

  <!-- Font Awesome CSS -->
  <link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" media="screen">

  <!-- Slicknav -->
  <link rel="stylesheet" type="text/css" href="css/slicknav.css" media="screen">
  
  <!-- Bootstrap Select -->
  <link rel="stylesheet" href="bower_components/bootstrap-select/dist/css/bootstrap-select.min.css">

  <!-- Timepicker -->
  <link rel="stylesheet" type="text/css" href="css/jquery.timepicker.css" />
  <link rel="stylesheet" type="text/css" href="css/jquery.ptTimeSelect.css" />
  <link rel="stylesheet" type="text/css" href="css/jquery.weekLine.css" />

  <link rel="stylesheet" href="bower_components/basictable/basictable.css">
  
  <link rel="stylesheet" type="text/css" href="css/tooltipster.css" />
  <link href="css/pnotify.custom.min.css" media="all" rel="stylesheet" type="text/css" />

  <!-- Margo CSS Styles  -->
  <link rel="stylesheet" type="text/css" href="css/style.css" media="screen">

  <!-- Responsive CSS Styles  -->
  <link rel="stylesheet" type="text/css" href="css/responsive.css" media="screen">

  <!-- Css3 Transitions Styles  -->
  <link rel="stylesheet" type="text/css" href="css/animate.css" media="screen">

  <!-- Color CSS Styles  -->
  <link rel="stylesheet" type="text/css" href="css/colors/jade.css" title="jade" media="screen" />

  <!-- Margo JS  -->
  <script src="js/jquery-2.1.4.min.js" onload="window.$ = window.jQuery;"></script>
  <script type="text/javascript" src="js/jquery.migrate.js"></script>
  <script type="text/javascript" src="js/modernizrr.js"></script>
  <script type="text/javascript" src="asset/js/bootstrap.min.js"></script>
  <script src="bower_components/bootstrap-select/dist/js/bootstrap-select.min.js"></script>
  <script type="text/javascript" src="js/jquery.fitvids.js"></script>
  <script type="text/javascript" src="js/owl.carousel.min.js"></script>
  <script type="text/javascript" src="js/nivo-lightbox.min.js"></script>
  <script type="text/javascript" src="js/jquery.isotope.min.js"></script>
  <script type="text/javascript" src="js/jquery.appear.js"></script>
  <script type="text/javascript" src="js/count-to.js"></script>
  <script type="text/javascript" src="js/jquery.textillate.js"></script>
  <script type="text/javascript" src="js/jquery.lettering.js"></script>
  <script type="text/javascript" src="js/jquery.easypiechart.min.js"></script>
  <script type="text/javascript" src="js/jquery.nicescroll.min.js"></script>
  <script type="text/javascript" src="js/jquery.parallax.js"></script>
  <script type="text/javascript" src="js/mediaelement-and-player.js"></script>
  <script type="text/javascript" src="js/jquery.slicknav.js"></script>
  <script src="js/jquery.timepicker.js"></script>
  <script src="js/jquery.ptTimeSelect.js"></script>
  <script src="js/jquery.weekLine.min.js"></script>
  <script type="text/javascript" src='bower_components/moment/min/moment.min.js'></script>
  <script src="js/datepair.min.js"></script>
  <script src="js/jquery.datepair.min.js"></script>
  <script type="text/javascript" src='bower_components/basictable/jquery.basictable.min.js'></script>
  <script type="text/javascript" src="js/jquery.tooltipster.min.js"></script>
  <script type="text/javascript" src="js/pnotify.custom.min.js"></script>

  <!--[if IE 8]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <!--[if lt IE 9]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <style>
    /*Stripe*/
    .term_details>tbody>tr:nth-of-type(even){background-color:#f9f9f9}
    /*Hover*/
    /*.term_details>tbody>tr:hover{background-color:#f5f5f5}*/
    /*Condensed*/
    .term_details>tbody>tr>td,.term_details>tbody>tr>th,.term_details>tfoot>tr>td,.term_details>tfoot>tr>th,.term_details>thead>tr>td,.term_details>thead>tr>th{padding:5px}
    /*Stripe*/
    .course_details>tbody>tr:nth-of-type(even){background-color:#f9f9f9}
    /*Hover*/
    .course_details>tbody>tr:hover{background-color:#f5f5f5}
    /*Condensed*/
    .course_details>tbody>tr>td,.course_details>tbody>tr>th,.course_details>tfoot>tr>td,.course_details>tfoot>tr>th,.course_details>thead>tr>td,.course_details>thead>tr>th{padding:5px}
  </style>
</head>

<body>

  <!-- Full Body Container -->
  <div id="container">

    <!-- Start Header Section -->
    <div class="hidden-header"></div>
    <header class="clearfix"></header>
    <!-- End Header Section -->


        <!-- Start Content -->
    <div id="content">
      <div class="container">
        <div class="page-content">

          <div class="row sidebar-page">
          
                    <!--Sidebar-->
          <div class="col-sm-3 col-xs-12 sidebar left-sidebar">

            <div class="widget widget-categories">
              <h4>Semesters <span class="head-line"></span></h4>
              <select id="semesters" class="selectpicker col-xs-12"><!-- Data loaded from api --></select>
            </div>
            
            <!-- Tags Widget -->
            <div class="widget widget-tags">
              <h4>Selections <span class="head-line"></span></h4>
              <div class="tagcloud" id="course_selections">
              </div>
            </div>
            <!-- Categories Widget -->
            <div class="widget widget-categories">
              <h4>Departments <span class="head-line"></span></h4>
              <select id="departments" class="selectpicker col-xs-12" data-live-search="true"><!-- Data loaded from api --></select>
            </div>

          </div>
          <!--End sidebar-->
          <!-- Page Content -->
          <div class="col-sm-9 col-xs-12 page-content">
            
            <!-- Classic Heading -->
            <!-- <h4 class="classic-title"><span>Courses</span></h4> -->
            <div id="filters"></div>
            <div id="dept_class_list"><div class="loader"></div> <div class="status">Loading Courses...</div></div>
                        
          </div>
          <!-- End Page Content-->
                 
          
        </div>
      </div>
    </div>
    </div>
    <!-- End content -->
    <!-- End Home Page Slider -->


    <div id="footer-container"></div>
  </div>
  <script type="text/javascript" src="js/script.js"></script>

<script type="text/javascript" src="asset/js/schedulizer_bundle.js"></script>

<script>
  $("#"+mscSchedulizer_config.html_elements.filters_container).html(mscSchedulizer.filtersDisplay());

  mscSchedulizer.updateFiltersDisplay(mscSchedulizer.schedule_filters);
  mscSchedulizer.getDepartments(mscSchedulizer.getDepartmentCoursesDetails);        // Department selected - View Department Courses
  $("#"+mscSchedulizer_config.html_elements.departments_select).on('changed.bs.select', function (e, clickedIndex, newValue, oldValue) {
      if($("#"+mscSchedulizer_config.html_elements.departments_select).val() != ""){
        mscSchedulizer.setDepartmentVar($("#"+mscSchedulizer_config.html_elements.departments_select).val());
          $("#"+mscSchedulizer_config.html_elements.department_class_list).html("<div class=\"loader\"></div> <div class=\"status\">Loading Courses...</div>");
          //Get From Endpoint - Department Courses
          mscSchedulizer.getDepartmentCoursesDetails($("#"+mscSchedulizer_config.html_elements.departments_select).val());
      }
  });
  $("#"+mscSchedulizer_config.html_elements.filters.not_full).click(function(){
    mscSchedulizer.schedule_filters.NotFull = !mscSchedulizer.schedule_filters.NotFull;
    mscSchedulizer.updateFilters(mscSchedulizer.schedule_filters);
    $("#"+mscSchedulizer_config.html_elements.department_class_list).html(mscSchedulizer.getDepartmentCoursesOutput(mscSchedulizer.department_courses));
    $('.course_details').basictable();
  });
  $("#"+mscSchedulizer_config.html_elements.filters.morrisville_campus).click(function(){
      mscSchedulizer.schedule_filters.Campuses.Morrisville = !mscSchedulizer.schedule_filters.Campuses.Morrisville;
      mscSchedulizer.updateFilters(mscSchedulizer.schedule_filters);
      $("#"+mscSchedulizer_config.html_elements.department_class_list).html(mscSchedulizer.getDepartmentCoursesOutput(mscSchedulizer.department_courses));
      $('.course_details').basictable();
  });
  $("#"+mscSchedulizer_config.html_elements.filters.norwich_campus).click(function(){
      mscSchedulizer.schedule_filters.Campuses.Norwich = !mscSchedulizer.schedule_filters.Campuses.Norwich;
      mscSchedulizer.updateFilters(mscSchedulizer.schedule_filters);
      $("#"+mscSchedulizer_config.html_elements.department_class_list).html(mscSchedulizer.getDepartmentCoursesOutput(mscSchedulizer.department_courses));
      $('.course_details').basictable();
  });
  $("#"+mscSchedulizer_config.html_elements.filters.show_online).click(function(){
      mscSchedulizer.schedule_filters.ShowOnline = !mscSchedulizer.schedule_filters.ShowOnline;
      mscSchedulizer.updateFilters(mscSchedulizer.schedule_filters);
      $("#"+mscSchedulizer_config.html_elements.department_class_list).html(mscSchedulizer.getDepartmentCoursesOutput(mscSchedulizer.department_courses));
      $('.course_details').basictable();
  });
  $("#"+mscSchedulizer_config.html_elements.filters.show_international).click(function(){
      mscSchedulizer.schedule_filters.ShowInternational = !mscSchedulizer.schedule_filters.ShowInternational;
      mscSchedulizer.updateFilters(mscSchedulizer.schedule_filters);
      $("#"+mscSchedulizer_config.html_elements.department_class_list).html(mscSchedulizer.getDepartmentCoursesOutput(mscSchedulizer.department_courses));
      $('.course_details').basictable();
  });
  //Semester select
  $("#"+mscSchedulizer_config.html_elements.semesters_select).on('changed.bs.select', function (e, clickedIndex, newValue, oldValue) {
      mscSchedulizer.setSemesterVar(JSON.parse(unescape($("#"+mscSchedulizer_config.html_elements.semesters_select).val())));
      $("#"+mscSchedulizer_config.html_elements.department_class_list).html("<div class=\"loader\"></div> <div class=\"status\">Loading Courses...</div>");
      //Get From Endpoint - Department Courses
      mscSchedulizer.getDepartments(mscSchedulizer.getDepartmentCoursesDetails);
  });

   // Remove Course Selections
  $("#"+mscSchedulizer_config.html_elements.course_selections_list).on("click", "a.a_selection", function (event) {
      event.preventDefault();
      // //Remove Course
      var course = JSON.parse(unescape(this.getAttribute('data-value')));
      var index = node_generic_functions.searchListDictionaries(mscSchedulizer.classes_selected,{'DepartmentCode':course.DepartmentCode,'CourseNumber':course.CourseNumber,CourseTitle:course.CourseTitle,'CourseCRN':course.CourseCRN},true);
      if (index !== -1) {
        mscSchedulizer.classes_selected.splice(index,1);
        localStorage.setItem('classes_selected', JSON.stringify(mscSchedulizer.classes_selected));
        //reload selections area
        mscSchedulizer.loadSelections();
        mscSchedulizer.getDepartmentCoursesDetails();
      }
  });

    // Course selected - Add Course
  $("#"+mscSchedulizer_config.html_elements.department_class_list).on("click", "a.a_course", function (event) {
      event.preventDefault();
      //Add Course
      var course = JSON.parse(unescape(this.getAttribute('data-value')));
      var index = node_generic_functions.searchListDictionaries(mscSchedulizer.classes_selected,{'DepartmentCode':course.DepartmentCode,'CourseNumber':course.CourseNumber,'CourseTitle':course.CourseTitle,'CourseCRN':course.CourseCRN},true);
      if (index === -1) {
        mscSchedulizer.classes_selected.push(course);
        $(this).html("<i class=\"fa fa-minus-circle\"></i>");
      }
      else{
        // remove selection
          mscSchedulizer.classes_selected.splice(index,1);
          $(this).html("<i class=\"fa fa-plus-circle\"></i>");
      }
      // Store var and reload selections
      localStorage.setItem('classes_selected', JSON.stringify(mscSchedulizer.classes_selected));
      //reload selections area
      mscSchedulizer.loadSelections();
  });
  $("#"+mscSchedulizer_config.html_elements.department_class_list).on("click", "tr.a_course_section", function (event) {
      event.preventDefault();
      //Add Course
      var selected_row = $(this);
      var i = selected_row.parent('tbody');
      var course = JSON.parse(unescape(this.getAttribute('data-value')));
      var courseList = [course];
      // courseList.push(course);
      var index = node_generic_functions.searchListDictionaries(mscSchedulizer.classes_selected,{'DepartmentCode':course.DepartmentCode,'CourseNumber':course.CourseNumber,'CourseTitle':course.CourseTitle,'CourseCRN':course.CourseCRN},true);
      if (index === -1) {
        mscSchedulizer.classes_selected.push(course);
        $(i).find('tr').each(function(){
          var aRow = $(this);
          var rowCourse = JSON.parse(unescape(aRow.data("value")));
          var rowIndex = node_generic_functions.searchListDictionaries(courseList,{'DepartmentCode':rowCourse.DepartmentCode,'CourseNumber':rowCourse.CourseNumber,'CourseTitle':rowCourse.CourseTitle,'CourseCRN':rowCourse.CourseCRN},true);
          if(rowIndex!==-1){
            aRow.addClass("selected_section");
          }
        });
      }
      else{
        // remove selection
        mscSchedulizer.classes_selected.splice(index,1);
        $(i).find('tr').each(function(){
          var aRow = $(this);
          var rowCourse = JSON.parse(unescape(aRow.data("value")));
          var rowIndex = node_generic_functions.searchListDictionaries(courseList,{'DepartmentCode':rowCourse.DepartmentCode,'CourseNumber':rowCourse.CourseNumber,'CourseTitle':rowCourse.CourseTitle,'CourseCRN':rowCourse.CourseCRN},true);
          if(rowIndex!==-1){
            aRow.removeClass("selected_section");
          }
        });
      }
      // Store var and reload selections
      localStorage.setItem('classes_selected', JSON.stringify(mscSchedulizer.classes_selected));
      // reload selections area
      mscSchedulizer.loadSelections();
  });

</script>

</body>

</html>